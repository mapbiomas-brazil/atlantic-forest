/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var varzea = /* color: #ffc82d */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.98359395434208, -22.685500152072414],
                  [-42.98359395434208, -22.69167686869919],
                  [-42.97998906542607, -22.687242331101757]]]),
            {
              "reference": 11,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.0201578276331, -22.680115095076907],
                  [-43.01535130907841, -22.680907028489923],
                  [-43.01243306567021, -22.677580877416172],
                  [-43.01809789110966, -22.677264096915238]]]),
            {
              "reference": 11,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.96705955399438, -22.731843527774334],
                  [-42.96362632645532, -22.737543192396373],
                  [-42.96242469681665, -22.731526872773927]]]),
            {
              "reference": 11,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.97581428421899, -22.74213441610501],
                  [-42.978732527627194, -22.743875874414027],
                  [-42.978217543496335, -22.745775621808804],
                  [-42.973239363564694, -22.744667439037705]]]),
            {
              "reference": 11,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.91704419281699, -22.66854000070204],
                  [-42.9287171664498, -22.678994035874194],
                  [-42.92597058441855, -22.682478537166464],
                  [-42.91567090180136, -22.67012399664464]]]),
            {
              "reference": 11,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.83136744528152, -22.53528777894981],
                  [-42.82896418600418, -22.534653561718446],
                  [-42.8303374770198, -22.525615649700057]]]),
            {
              "reference": 11,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.802049072645914, -22.48748789978298],
                  [-42.80840054359318, -22.492563287504062],
                  [-42.80119076576115, -22.489549798493353]]]),
            {
              "reference": 11,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.58035460234999, -22.584341005216274],
                  [-42.587049396051164, -22.587986400868303],
                  [-42.58018294097304, -22.58608446734786],
                  [-42.57589140654921, -22.582756020493257]]]),
            {
              "reference": 11,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.39427845082065, -22.540824349607636],
                  [-42.396681710097994, -22.535750733640484],
                  [-42.396681710097994, -22.54129999154514]]]),
            {
              "reference": 11,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.26628132980249, -22.577306105347354],
                  [-42.260616504363036, -22.575404024375434],
                  [-42.26507970016382, -22.571124246203468]]]),
            {
              "reference": 11,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.309539996794676, -22.58459717250291],
                  [-42.30353184860132, -22.58364618562595],
                  [-42.302330218962645, -22.581902692633857],
                  [-42.30490513961694, -22.581902692633857]]]),
            {
              "reference": 11,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.33940907638452, -22.697559306506804],
                  [-42.341812335661864, -22.702468594925314],
                  [-42.33563252609155, -22.699618061782342]]]),
            {
              "reference": 11,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.3574335209646, -22.641644362713382],
                  [-42.35108205001733, -22.643070239236927],
                  [-42.35297032516382, -22.639743170991267]]]),
            {
              "reference": 11,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.35571690719507, -22.73081233385591],
                  [-42.35537358444116, -22.739520124685832],
                  [-42.35314198654077, -22.73698700636918]]]),
            {
              "reference": 11,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.56436339159378, -22.791411200037995],
                  [-42.556981952384795, -22.791569458214106],
                  [-42.560758502677764, -22.79014512801694]]]),
            {
              "reference": 11,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.440374581144816, -22.91165190739608],
                  [-42.450159279631144, -22.908647625122395],
                  [-42.44106122665263, -22.914814237861982]]]),
            {
              "reference": 11,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.457884041594035, -22.923352161568815],
                  [-42.45307752303935, -22.923826474890134],
                  [-42.45633908920146, -22.920822462478075]]]),
            {
              "reference": 11,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.537534920500285, -22.874647162180917],
                  [-42.54216977767802, -22.873223701248516],
                  [-42.53890821151591, -22.8776521973742]]]),
            {
              "reference": 11,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.07439078824442, -22.606859071640816],
                  [-42.076279063390906, -22.613039326736665],
                  [-42.072845835851844, -22.610979272552907]]]),
            {
              "reference": 11,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.11110972972596, -22.603674283777938],
                  [-42.11334132762635, -22.608586930580888],
                  [-42.10956477733338, -22.606209865319073]]]),
            {
              "reference": 11,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.2450056037494, -22.62728507811294],
                  [-42.244318958241585, -22.633464415256043],
                  [-42.24225902171815, -22.629027996205693]]]),
            {
              "reference": 11,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.036485770709184, -22.360485628701944],
                  [-42.03734407759395, -22.37128047694871],
                  [-42.03408251143184, -22.37350284181255],
                  [-42.03288088179317, -22.360803136182703]]]),
            {
              "reference": 11,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.949623216428655, -22.30195524498574],
                  [-41.96627436999311, -22.315295534128545],
                  [-41.96404277209272, -22.320377213769802],
                  [-41.95030986193647, -22.308149109149088]]]),
            {
              "reference": 11,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.96868878972012, -22.205450666491448],
                  [-41.96319562565762, -22.201636293504436],
                  [-41.9650839008041, -22.19623242103046]]]),
            {
              "reference": 11,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.084402965269746, -22.93024293018815],
                  [-44.0900677907092, -22.932614359548072],
                  [-44.082171367369355, -22.933879104894036]]]),
            {
              "reference": 11,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.80136258381479, -22.89908746392535],
                  [-43.79020459431284, -22.900510653630025],
                  [-43.794839451490574, -22.896241039719605]]]),
            {
              "reference": 11,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.74497182148569, -22.93165895285038],
                  [-43.74617345112436, -22.927232219897693],
                  [-43.75346905964487, -22.930710379397496]]]),
            {
              "reference": 11,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.70913977315051, -22.94865844881265],
                  [-43.71592039754016, -22.94589210505717],
                  [-43.705534884234496, -22.95466517195022]]]),
            {
              "reference": 11,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.69738096882922, -22.95577164449252],
                  [-43.697810122271605, -22.951898951000615],
                  [-43.69909758259875, -22.95490227397118]]]),
            {
              "reference": 11,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.59146940815303, -23.026504668181943],
                  [-43.58983862507198, -23.029901283236914],
                  [-43.58820784199092, -23.02761055224763]]]),
            {
              "reference": 11,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.60580313312862, -23.01315435202168],
                  [-43.61266958820674, -23.010468329916847],
                  [-43.60717642414424, -23.01426034557866]]]),
            {
              "reference": 11,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.572157503245805, -23.00699222192656],
                  [-43.572672487376664, -23.003990056594823],
                  [-43.57747900593135, -23.011100339929357]]]),
            {
              "reference": 11,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.627345419229016, -22.78480726868021],
                  [-43.62648711234425, -22.790029944423278],
                  [-43.62442717582081, -22.786389918812784]]]),
            {
              "reference": 11,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.58872028104223, -22.56035934285139],
                  [-43.586832005895744, -22.56146901436863],
                  [-43.583570439733634, -22.55734733229783]]]),
            {
              "reference": 11,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.58940692655004, -22.5479938276863],
                  [-43.59146686307348, -22.55132311387641],
                  [-43.58597369901098, -22.548152366945395]]]),
            {
              "reference": 11,
              "system:index": "34"
            })]),
    aflora = /* color: #ff571e */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.73035839467949, -22.332297664952712],
                  [-42.72606686025566, -22.336505431290767],
                  [-42.72460773855156, -22.33420308430539]]]),
            {
              "reference": 29,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.776706966456835, -22.337299335230774],
                  [-42.76992634206719, -22.334838218304757],
                  [-42.770956310328906, -22.33269462946452],
                  [-42.775934490260546, -22.335076392808787]]]),
            {
              "reference": 29,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.82528713613457, -22.350398097573606],
                  [-42.82975033193535, -22.35317646466564],
                  [-42.83043697744316, -22.35587539679167],
                  [-42.826145443019335, -22.352462032704537]]]),
            {
              "reference": 29,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.8130991783709, -22.388417224785925],
                  [-42.80812099843926, -22.388258502629256],
                  [-42.81078174978203, -22.386036373418474],
                  [-42.813185009059374, -22.386829995068872]]]),
            {
              "reference": 29,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.73370579153008, -22.35524035864217],
                  [-42.73241833120293, -22.356431052797937],
                  [-42.7307017174334, -22.353970273659375]]]),
            {
              "reference": 29,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.844599041041796, -22.45536499067914],
                  [-42.844599041041796, -22.456237538515524],
                  [-42.841165813502734, -22.45520634502792]]]),
            {
              "reference": 29,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.8614218559832, -22.463217723476845],
                  [-42.862880977687304, -22.462821131478353],
                  [-42.86322430044121, -22.464010904068807],
                  [-42.86167934804863, -22.464169539642374]]]),
            {
              "reference": 29,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.074625286158984, -22.451795419616104],
                  [-43.071878704127734, -22.454016496857022],
                  [-43.07024792104668, -22.452192043161546],
                  [-43.071621212062304, -22.450208914088982]]]),
            {
              "reference": 29,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.103292736110156, -22.44560794541507],
                  [-43.10689762502617, -22.446083914770195],
                  [-43.1042368736834, -22.448463737043763]]]),
            {
              "reference": 29,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.09436634450859, -22.438547541517213],
                  [-43.09041813283867, -22.438468209094935],
                  [-43.09445217519707, -22.436564217351897],
                  [-43.0961687889666, -22.438864870752788]]]),
            {
              "reference": 29,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.11015919118828, -22.460838154461303],
                  [-43.108270916041796, -22.458855149071393],
                  [-43.11196163564629, -22.45750668920067],
                  [-43.111274990138476, -22.459013790546656]]]),
            {
              "reference": 29,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.13238933950371, -22.478128758827605],
                  [-43.13041523366875, -22.474401150469777],
                  [-43.13333347707695, -22.475908068058075]]]),
            {
              "reference": 29,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.0539965093117, -22.490387255802716],
                  [-43.05047745108416, -22.489514923068164],
                  [-43.05356735586932, -22.48895979937422]]]),
            {
              "reference": 29,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.07399505972674, -22.493004221013724],
                  [-43.07021850943377, -22.49292491976477],
                  [-43.07468170523455, -22.490545861163696]]]),
            {
              "reference": 29,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.24494215415552, -22.43185558005788],
                  [-43.243740524516845, -22.43344229549642],
                  [-43.2398781435354, -22.430903542087417],
                  [-43.24631544517114, -22.430506857672377]]]),
            {
              "reference": 29,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.1999668733938, -22.460651640991898],
                  [-43.19498869346216, -22.458192706777762],
                  [-43.20013853477075, -22.458589312020973],
                  [-43.20065351890161, -22.459541159974552]]]),
            {
              "reference": 29,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.185547317729736, -22.442724217297286],
                  [-43.18116995261743, -22.440344296545227],
                  [-43.18391653464868, -22.440344296545227],
                  [-43.18674894736841, -22.442486227059415]]]),
            {
              "reference": 29,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.183573211894775, -22.451608893979614],
                  [-43.1820282595022, -22.452481465455772],
                  [-43.18065496848657, -22.451608893979614],
                  [-43.1834873812063, -22.450419014935395]]]),
            {
              "reference": 29,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.19138380454614, -22.47359089955288],
                  [-43.18700643943384, -22.474463332627412],
                  [-43.18872305320337, -22.472559835197963]]]),
            {
              "reference": 29,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.567060615114904, -23.28422748987161],
                  [-44.564571525149084, -23.283557346246504],
                  [-44.56392779498551, -23.282256469580837]]]),
            {
              "reference": 29,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.55667510180924, -23.278984511482456],
                  [-44.55860629229996, -23.281310369477545],
                  [-44.557576324038244, -23.28087673801697],
                  [-44.55710425525162, -23.280127734895437],
                  [-44.55611720233414, -23.279772942472714],
                  [-44.556331779055334, -23.27941814910474]]]),
            {
              "reference": 29,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.532988361269716, -23.273465363859287],
                  [-44.535520366579775, -23.27527882330517],
                  [-44.533975414187196, -23.275475936974676],
                  [-44.53290253058124, -23.27417498136533]]]),
            {
              "reference": 29,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.60962631803791, -23.2608646094323],
                  [-44.608381773055, -23.260273202699793],
                  [-44.607480550826, -23.25893267105819],
                  [-44.608768011153145, -23.25972122071534]]]),
            {
              "reference": 29,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.59288476217281, -23.247761592193385],
                  [-44.59284184682857, -23.248668499875826],
                  [-44.591983539943804, -23.247682730364343]]]),
            {
              "reference": 29,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.7252181589008, -23.267434679336247],
                  [-44.72753558748967, -23.268893399472443],
                  [-44.72783599489934, -23.27019440666074],
                  [-44.72650561922795, -23.269642465768772]]]),
            {
              "reference": 29,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.82272182101018, -23.22772770753383],
                  [-44.820275646388595, -23.226860094601868],
                  [-44.82113395327336, -23.226150225281955],
                  [-44.82388053530461, -23.227293901772644]]]),
            {
              "reference": 29,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.802294117152755, -23.219051324510982],
                  [-44.801307064235274, -23.218065336224832],
                  [-44.80207954043156, -23.21755261943947],
                  [-44.80310950869328, -23.218459732412747]]]),
            {
              "reference": 29,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.490428144446014, -22.951513956511313],
                  [-44.489913160315155, -22.952541419533247],
                  [-44.48944109152853, -22.950367930858736]]]),
            {
              "reference": 29,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.18705057961527, -22.89164768090079],
                  [-44.18400359017435, -22.891212790553897],
                  [-44.184861897059115, -22.889868575215285]]]),
            {
              "reference": 29,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.204087971277865, -22.883344988158004],
                  [-44.20546126229349, -22.883740365995966],
                  [-44.206062077112826, -22.88516371667736],
                  [-44.2046887860972, -22.88476834298519]]]),
            {
              "reference": 29,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.1627246049063, -22.5417731256292],
                  [-43.16109382182525, -22.542565855832606],
                  [-43.15774642497466, -22.542169491299976],
                  [-43.16057883769439, -22.541693852358467]]]),
            {
              "reference": 29,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.10659133464263, -22.56737600922935],
                  [-43.104188075365286, -22.566504162567348],
                  [-43.10530387431548, -22.565870088804843],
                  [-43.1063338425772, -22.566424903506523]]]),
            {
              "reference": 29,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.002157897056506, -22.47755795638685],
                  [-43.000183791221545, -22.479025185012723],
                  [-43.000441283286975, -22.476764853359462]]]),
            {
              "reference": 29,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.53877664483376, -22.31499745697931],
                  [-42.532940158017354, -22.31944394627883],
                  [-42.535686740048604, -22.313727005449582]]]),
            {
              "reference": 29,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.541179904111104, -22.263376063294405],
                  [-42.54547143853493, -22.258927790011764],
                  [-42.54272485650368, -22.264805835397603]]]),
            {
              "reference": 29,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.635312545408325, -22.2640621666435],
                  [-42.640290725339966, -22.262791252075402],
                  [-42.635312545408325, -22.267080542486838]]]),
            {
              "reference": 29,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.808862197507935, -22.19160163257066],
                  [-42.807145583738404, -22.191522159685682],
                  [-42.8042273403302, -22.189455848893402],
                  [-42.80920552026184, -22.19064795498319]]]),
            {
              "reference": 29,
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.806373107542115, -22.184846276829443],
                  [-42.806888091672974, -22.183972030583377],
                  [-42.80774639855774, -22.186117898022292]]]),
            {
              "reference": 29,
              "system:index": "37"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.78731869470032, -22.222115895255584],
                  [-42.78422878991516, -22.22251317262218],
                  [-42.781653869260865, -22.221400793159713],
                  [-42.7848296047345, -22.221400793159713]]]),
            {
              "reference": 29,
              "system:index": "38"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.75787876855286, -22.23053793443355],
                  [-42.75847958337219, -22.22982287528852],
                  [-42.7602820278302, -22.233239236064332]]]),
            {
              "reference": 29,
              "system:index": "39"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.862390571080695, -22.25939956209083],
                  [-42.858614020787726, -22.256063275607065],
                  [-42.86144643350745, -22.257254815621298]]]),
            {
              "reference": 29,
              "system:index": "40"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.854408317052375, -22.2452595167516],
                  [-42.85475163980628, -22.243114553712434],
                  [-42.85595326944495, -22.247086681583422]]]),
            {
              "reference": 29,
              "system:index": "41"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.848915152989875, -22.244782861136688],
                  [-42.849172645055305, -22.248039975512338],
                  [-42.848142676793586, -22.245736170744607]]]),
            {
              "reference": 29,
              "system:index": "42"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.76108750285586, -22.302694249264412],
                  [-42.75756844462832, -22.30221778931869],
                  [-42.758941735643944, -22.300550166710618]]]),
            {
              "reference": 29,
              "system:index": "43"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.76726731242617, -22.303647164280175],
                  [-42.76623734416445, -22.3046000727949],
                  [-42.76623734416445, -22.302058968975636]]]),
            {
              "reference": 29,
              "system:index": "44"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.70289429606875, -22.314128800336714],
                  [-42.700748528856835, -22.316510880614302],
                  [-42.702207650560936, -22.3126995326596]]]),
            {
              "reference": 29,
              "system:index": "45"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.601127253663215, -22.350054979016264],
                  [-42.59717904199329, -22.349499297582035],
                  [-42.59872399438587, -22.34862607942299]]]),
            {
              "reference": 29,
              "system:index": "46"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.59906731713978, -22.336241669329457],
                  [-42.59623490442005, -22.335288976833308],
                  [-42.60001145471302, -22.334892019705702]]]),
            {
              "reference": 29,
              "system:index": "47"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.44398360201837, -22.28216370901255],
                  [-42.439091252775206, -22.28005902283859],
                  [-42.440593289823546, -22.278867677001863],
                  [-42.44372610995294, -22.280813536619046]]]),
            {
              "reference": 29,
              "system:index": "48"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.43102316805841, -22.282044576678715],
                  [-42.432396459074035, -22.28410952276345],
                  [-42.429864453763976, -22.282878500884028]]]),
            {
              "reference": 29,
              "system:index": "49"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.30124716708185, -22.35997511804671],
                  [-42.300560521574035, -22.362673918453805],
                  [-42.298328923673644, -22.361800782868293]]]),
            {
              "reference": 29,
              "system:index": "50"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.27129225680353, -22.335286605797574],
                  [-42.26768736788751, -22.33814466380881],
                  [-42.27043394991876, -22.3349690401805]]]),
            {
              "reference": 29,
              "system:index": "51"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.13791136691095, -22.397396461704066],
                  [-42.13859801241876, -22.39878518317121],
                  [-42.1366239065838, -22.39910260327306]]]),
            {
              "reference": 29,
              "system:index": "52"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.1313432043362, -22.32809759414525],
                  [-42.12919743712428, -22.3305985270124],
                  [-42.12705166991237, -22.33091610258082],
                  [-42.12829621489528, -22.327383033662322]]]),
            {
              "reference": 29,
              "system:index": "53"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.107696849660904, -22.308486038716694],
                  [-42.10610898192409, -22.307136120630012],
                  [-42.10958512480739, -22.30820811547146]]]),
            {
              "reference": 29,
              "system:index": "54"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.10158141310695, -22.26387228155319],
                  [-42.10057290251735, -22.260953128505747],
                  [-42.10306199248317, -22.261052420425933]]]),
            {
              "reference": 29,
              "system:index": "55"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.10733206923488, -22.26325668291524],
                  [-42.10861952956203, -22.260714827609934],
                  [-42.10859807188991, -22.263892139528693]]]),
            {
              "reference": 29,
              "system:index": "56"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.094682484143085, -22.256413401206267],
                  [-42.08837392854006, -22.256294246945078],
                  [-42.09039094971926, -22.25573819238535],
                  [-42.09562662171633, -22.255579319248366]]]),
            {
              "reference": 29,
              "system:index": "57"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.04646479150539, -22.261009658439914],
                  [-42.046936860292014, -22.262558603747955],
                  [-42.04530607721096, -22.26132739220824]]]),
            {
              "reference": 29,
              "system:index": "58"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.064561699897546, -22.32840662308946],
                  [-42.065548752815026, -22.330629671816435],
                  [-42.0632742395704, -22.329796032695434]]]),
            {
              "reference": 29,
              "system:index": "59"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.97815857347012, -22.417197281656172],
                  [-41.98133430894375, -22.41997431495817],
                  [-41.97953186448574, -22.420291686656917],
                  [-41.97790108140469, -22.418546133338246]]]),
            {
              "reference": 29,
              "system:index": "60"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.97292290147305, -22.425600044449954],
                  [-41.97378120835781, -22.42988432758234],
                  [-41.97257957871914, -22.428535586042212],
                  [-41.97215042527676, -22.426710797217478]]]),
            {
              "reference": 29,
              "system:index": "61"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.39975891526699, -22.377194335142114],
                  [-42.39357910569668, -22.376003818524808],
                  [-42.39855728562832, -22.37560697738929]]]),
            {
              "reference": 29,
              "system:index": "62"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.37735710557461, -22.379099140546302],
                  [-42.377271274886134, -22.37671812971729],
                  [-42.38207779344082, -22.377353069921618]]]),
            {
              "reference": 29,
              "system:index": "63"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.02269110237492, -22.15587414358742],
                  [-42.02320608650578, -22.153489331515424],
                  [-42.02475103889836, -22.154125285353118],
                  [-42.02354940925969, -22.157305011429962]]]),
            {
              "reference": 29,
              "system:index": "64"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.06371817146672, -22.162074465807503],
                  [-42.060284943927655, -22.158258915240935],
                  [-42.065778107990155, -22.161438547899802]]]),
            {
              "reference": 29,
              "system:index": "65"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.993531259459786, -22.09706627511783],
                  [-41.99009803192072, -22.095157632364838],
                  [-41.99044135467463, -22.09118121039626]]]),
            {
              "reference": 29,
              "system:index": "66"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.974820169371895, -22.08290989391819],
                  [-41.98014167205744, -22.08768186640577],
                  [-41.97327521697932, -22.08450056933226]]]),
            {
              "reference": 29,
              "system:index": "67"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.93386997111949, -21.91131938645682],
                  [-41.93043674358043, -21.910841602666085],
                  [-41.92700351604137, -21.90606367662477],
                  [-41.93198169597301, -21.909089715056446]]]),
            {
              "reference": 29,
              "system:index": "68"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.90142597087535, -21.86029814940463],
                  [-41.90245593913707, -21.86444035673632],
                  [-41.89764942058238, -21.86173200400131]]]),
            {
              "reference": 29,
              "system:index": "69"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.91361392863902, -21.865874169740007],
                  [-41.90726245769176, -21.863484473401417],
                  [-41.91121066936168, -21.863165844201117]]]),
            {
              "reference": 29,
              "system:index": "70"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.85116313271661, -21.82935150733363],
                  [-41.85837291054864, -21.831901124240954],
                  [-41.85287974648614, -21.833335263777734]]]),
            {
              "reference": 29,
              "system:index": "71"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.85593520321606, -21.805000484505058],
                  [-41.86125670590161, -21.812331758024545],
                  [-41.857651816985594, -21.812969242329363],
                  [-41.852501975677, -21.80372544209981]]]),
            {
              "reference": 29,
              "system:index": "72"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.77988921322583, -21.826037044891322],
                  [-41.773022758147704, -21.826833823518644],
                  [-41.7726794353938, -21.823009245636918]]]),
            {
              "reference": 29,
              "system:index": "73"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.79602538265942, -21.790177415624623],
                  [-41.795682059905516, -21.796871894707117],
                  [-41.79310713925122, -21.792568336913252]]]),
            {
              "reference": 29,
              "system:index": "74"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.77988921322583, -21.78316381642231],
                  [-41.77439604916333, -21.78475784637308],
                  [-41.77628432430981, -21.782366794800808]]]),
            {
              "reference": 29,
              "system:index": "75"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.677878512053375, -21.738010221128196],
                  [-41.66998208871353, -21.736096759975606],
                  [-41.67255700936783, -21.733704897708314]]]),
            {
              "reference": 29,
              "system:index": "76"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.68903650155533, -21.708508198052506],
                  [-41.692126406340485, -21.703723516034653],
                  [-41.6957312952565, -21.70499944679116],
                  [-41.692126406340485, -21.70882717119826]]]),
            {
              "reference": 29,
              "system:index": "77"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.64251626840103, -21.717279701929414],
                  [-41.64148630013931, -21.71313323946686],
                  [-41.64800943246353, -21.717598655630223]]]),
            {
              "reference": 29,
              "system:index": "78"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.57528434344831, -21.653700393992064],
                  [-41.5775159413487, -21.650988062460616],
                  [-41.580090862003, -21.650828511959645],
                  [-41.581635814395575, -21.651945361762685],
                  [-41.57803092547956, -21.651785812319936],
                  [-41.57648597308698, -21.65465767530348]]]),
            {
              "reference": 29,
              "system:index": "79"
            })]),
    agro = /* color: #0000ff */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.890164196406, -21.799939301742015],
                  [-41.88836175194799, -21.799939301742015],
                  [-41.88819009057104, -21.798982987211616],
                  [-41.89067918053686, -21.799222066442724]]]),
            {
              "reference": 21,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.8861301540476, -21.80336604304888],
                  [-41.88690263024389, -21.802090986092974],
                  [-41.88784676781713, -21.80312697073427]]]),
            {
              "reference": 21,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.9441134591188, -21.938478826269858],
                  [-41.9437701363649, -21.939633243531365],
                  [-41.942053522595366, -21.93911574729684]]]),
            {
              "reference": 21,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.9377190728273, -22.019464312019622],
                  [-41.935573305615385, -22.019941730622275],
                  [-41.93600245905777, -22.01787290505826]]]),
            {
              "reference": 21,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.11762271628523, -22.139801249321632],
                  [-42.115820271827225, -22.138211197558498],
                  [-42.11813770041609, -22.137813681812606],
                  [-42.12019763693953, -22.139483240405244]]]),
            {
              "reference": 21,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.112043721534256, -22.122866275687983],
                  [-42.11427531943465, -22.12358187914105],
                  [-42.112301213599686, -22.124695032845935]]]),
            {
              "reference": 21,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.16946445212508, -22.144650796309918],
                  [-42.16611705527449, -22.146161276829506],
                  [-42.166975362159256, -22.144014799663868]]]),
            {
              "reference": 21,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.15227694235961, -22.257256318832535],
                  [-42.15390772544067, -22.255747033118027],
                  [-42.153993556129144, -22.258209543532054]]]),
            {
              "reference": 21,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.157255122291254, -22.256064778831103],
                  [-42.15811342917602, -22.257415190066514],
                  [-42.15656847678344, -22.25876558827606]]]),
            {
              "reference": 21,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.138715693580316, -22.280608455021017],
                  [-42.13828654013793, -22.27901999789097],
                  [-42.13991732321899, -22.280370187601765]]]),
            {
              "reference": 21,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.11871714316528, -22.36885777521465],
                  [-42.11936087332885, -22.36766718729599],
                  [-42.12094874106567, -22.369135577597365]]]),
            {
              "reference": 21,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.108760783301996, -22.371159549654042],
                  [-42.10991949759643, -22.369373693484224],
                  [-42.11017698966186, -22.371238920507643]]]),
            {
              "reference": 21,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.130147513724054, -22.308357756444273],
                  [-42.131606635428156, -22.30764309489679],
                  [-42.131907042837824, -22.308913601785935],
                  [-42.13023334441253, -22.30911211744319]]]),
            {
              "reference": 21,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.13478294448525, -22.298556823880237],
                  [-42.13431087569863, -22.298318587054787],
                  [-42.1346112831083, -22.296928864143236],
                  [-42.13705745772988, -22.29796123105492],
                  [-42.13525501327187, -22.298358293220574]]]),
            {
              "reference": 21,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.00211501380818, -22.25542528745616],
                  [-42.000741722792554, -22.253518793653754],
                  [-42.00207209846394, -22.253081885167997]]]),
            {
              "reference": 21,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.01576209327595, -22.250897322291266],
                  [-42.015461685866285, -22.25232722184535],
                  [-42.0150325324239, -22.25073844366179]]]),
            {
              "reference": 21,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.03172186746052, -22.264713452770444],
                  [-42.032580174345284, -22.263323395838643],
                  [-42.032580174345284, -22.264951746858156]]]),
            {
              "reference": 21,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.00468194507001, -22.21680567378347],
                  [-42.00541150592206, -22.21601108559279],
                  [-42.00562608264325, -22.21684540307486],
                  [-42.00498235247968, -22.21748107020686]]]),
            {
              "reference": 21,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.974241202130884, -22.192926334772974],
                  [-41.97488493229446, -22.192052138810084],
                  [-41.9763869693428, -22.193005806863436],
                  [-41.975700323834985, -22.194356825520757]]]),
            {
              "reference": 21,
              "system:index": "18"
            })]),
    flo = /* color: #999900 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.750168391364845, -21.67876396831956],
                  [-41.753429957526954, -21.676929480204336],
                  [-41.75351578821543, -21.678365168541497],
                  [-41.75154168238047, -21.68075795065814]]]),
            {
              "reference": 3,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.76261384119395, -21.69327952902918],
                  [-41.76158387293223, -21.695432811806484],
                  [-41.76081139673594, -21.691684483993967]]]),
            {
              "reference": 3,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.700093905461905, -21.673722657313466],
                  [-41.70103804303515, -21.672207159289087],
                  [-41.702582995427726, -21.671967868671153],
                  [-41.70172468854296, -21.673722657313466]]]),
            {
              "reference": 3,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.94123345604955, -21.762160025735074],
                  [-41.94183427086889, -21.761203459209522],
                  [-41.9425209163767, -21.76231945286952],
                  [-41.94200593224584, -21.763196298943388]]]),
            {
              "reference": 3,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.91728669396459, -21.76295715963636],
                  [-41.91634255639135, -21.76239916637034],
                  [-41.91565591088354, -21.761283173330146],
                  [-41.9176300167185, -21.761442601438585]]]),
            {
              "reference": 3,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.926899731073966, -21.768616683017086],
                  [-41.92810136071264, -21.767421027660916],
                  [-41.929646313105216, -21.76853697296998],
                  [-41.92707139245092, -21.769812328409458]]]),
            {
              "reference": 3,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.96955758324682, -21.869016119027883],
                  [-41.970415890131584, -21.865909574354664],
                  [-41.972647488031974, -21.86718406239828]]]),
            {
              "reference": 3,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.09047884665649, -22.36572332813816],
                  [-42.089534709083246, -22.36754891760412],
                  [-42.08936304770629, -22.365564580096926]]]),
            {
              "reference": 3,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.591973899060086, -21.65643719481168],
                  [-41.59214556043704, -21.659189309268562],
                  [-41.59158766096194, -21.66046563438693],
                  [-41.590729354077176, -21.659189309268562],
                  [-41.59115850751956, -21.65679616923948]]]),
            {
              "reference": 3,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.60059988325198, -21.651331684064285],
                  [-41.59991323774417, -21.651092358816445],
                  [-41.59879743879397, -21.65177044598798],
                  [-41.59793913190921, -21.650454156215527],
                  [-41.59763872449954, -21.649536735033042],
                  [-41.601715682202176, -21.650454156215527]]]),
            {
              "reference": 3,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.5736061317261, -21.653365932648423],
                  [-41.57261907880862, -21.65368502786397],
                  [-41.57373487775882, -21.654682195865036],
                  [-41.57193243330081, -21.654881628638428],
                  [-41.57193243330081, -21.652967062636865],
                  [-41.573305724316434, -21.652647965833896]]]),
            {
              "reference": 3,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.55725882845415, -21.643345217886797],
                  [-41.554941399865285, -21.64143049887502],
                  [-41.554168923668996, -21.64194907111429],
                  [-41.553482278161184, -21.64155016955706],
                  [-41.55464099245562, -21.63991466165217],
                  [-41.557430489831106, -21.641829400762823]]]),
            {
              "reference": 3,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.57275126772417, -21.644861019098148],
                  [-41.572193368249074, -21.64498068693709],
                  [-41.572193368249074, -21.64581835903248],
                  [-41.57163546877398, -21.645499246426365],
                  [-41.571892960839406, -21.644262678415696],
                  [-41.5709917386104, -21.644023341448438],
                  [-41.57112048464312, -21.64354466632376],
                  [-41.57275126772417, -21.643943562371195]]]),
            {
              "reference": 3,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.56584189730181, -21.654194812651234],
                  [-41.56425402956499, -21.654194812651234],
                  [-41.563910706811086, -21.652878544989324],
                  [-41.56481192904009, -21.652639222306476]]]),
            {
              "reference": 3,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.57408164339556, -21.66931108645956],
                  [-41.57421038942827, -21.670906379138536],
                  [-41.57627032595171, -21.673498692097873],
                  [-41.5755836804439, -21.673618336186152],
                  [-41.57373832064165, -21.672461772507194],
                  [-41.57322333651079, -21.670627204193774]]]),
            {
              "reference": 3,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.562408669762746, -21.67621060038337],
                  [-41.56073497133745, -21.674774890587052],
                  [-41.56150744753374, -21.673977267855197],
                  [-41.5631382306148, -21.674455842023875]]]),
            {
              "reference": 3,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.55301020937456, -21.674216555138116],
                  [-41.55223773317827, -21.67365821752685],
                  [-41.5521519024898, -21.672661180699947],
                  [-41.55288146334185, -21.67238200915285],
                  [-41.55391143160357, -21.672820707055607]]]),
            {
              "reference": 3,
              "system:index": "16"
            })]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/

var regiaoID = 'reg_16'; // antigo 21
var coleta = false;

var anos = [1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021];
//if (coleta) {var anos = [2019]}

var RFtrees = 70;
if (coleta) {var RFtrees = 10}

var versao_out = 2;
var versao_pt = 'v3';
var versao_estavel = '1'
var dir_pt_in = 'projects/mapbiomas-workspace/AMOSTRAS/col7/MATA_ATLANTICA/SAMPLES/';

var bioma250mil = ee.FeatureCollection('projects/mapbiomas-workspace/AUXILIAR/biomas_IBGE_250mil');
var bioma250mil_MA_vetor = bioma250mil.filterMetadata('Bioma','equals', 'Mata Atlntica');
var biomes = ee.Image('projects/mapbiomas-workspace/AUXILIAR/biomas-raster-41');
var bioma250mil_MA = biomes.mask(biomes.eq(2));
//Map.addLayer(bioma250mil_MA)
var palettes = require('users/mapbiomas/modules:Palettes.js');
var vis = {
    'min': 0,
    'max': 45,
    'palette': palettes.get('classification5')
};
var regioesCollection = ee.FeatureCollection('projects/mapbiomas-workspace/AUXILIAR/Mata_Atlantica_regions_col6_area2000');
//Map.addLayer(regioesCollection);

var visParMedian2 = {bands: ['swir1_median', 'nir_median', 'red_median'],gain: [0.08, 0.06, 0.2],gamma: 0.85}

var bioma = "MATAATLANTICA";

var pts = ee.FeatureCollection('projects/mapbiomas-workspace/AMOSTRAS/col7/MATA_ATLANTICA/SAMPLES/samples_stable_' + versao_pt + '_reg');
//Map.addLayer(pts, {}, 'pt', false)
var dirout = 'projects/mapbiomas-workspace/COLECAO7/classificacao-test/';

var limite = regioesCollection.filterMetadata('reg_id', "equals", regiaoID);



var mapa_estavel_col6 = ee.Image('projects/mapbiomas-workspace/AMOSTRAS/col7/MATA_ATLANTICA/MA_amostras_estaveis85a20_col6_v'+versao_estavel)
Map.addLayer(mapa_estavel_col6, vis, 'mapa_estavel_col6', false);
var blank = ee.Image(0).mask(0);
var outline = blank.paint(limite, 'AA0000', 2); 
var visPar = {'palette':'000000','opacity': 0.6};
Map.addLayer(outline, visPar, regiaoID, false);


var bandNames = ee.List(['gcvi_median_dry','gcvi_median_wet','red_median_wet','swir1_median_dry','gcvi_median','ndvi_median_wet','red_median','cai_median','savi_median_wet','swir1_median','gcvi_stdDev','green_min','swir1_median_wet','savi_median_dry','nir_median','swir2_median_wet','red_min','savi_median','nir_median_wet','evi2_median','red_median_dry','evi2_median_wet','swir2_median_dry','swir2_median','ndvi_median_dry','green_median_wet','green_median','latitude','wefi_median_wet','evi2_median_dry','longitude','ndwi_median_wet','ndwi_stdDev','ndwi_median','amp_ndvi_3anos','slope'])

var shuffle = function (collection, seed) {
    collection = collection.randomColumn('random', seed || 1)
        .sort('random', true)
        .map(function (feature) {
                var rescaled = ee.Number(feature.get('random')).multiply(1000000000).round();
                return feature.set('new_id', rescaled)});
    var randomIdList = ee.List(collection.reduceColumns(ee.Reducer.toList(), ['new_id']).get('list'));
    var sequentialIdList = ee.List.sequence(1, collection.size());
    var shuffled = collection.remap(randomIdList, sequentialIdList, 'new_id');
    return shuffled;
};
var asset_mosaicos_col6 = 'projects/nexgenmap/MapBiomas2/LANDSAT/BRAZIL/mosaics-2';

for (var i_ano=0;i_ano<anos.length; i_ano++){
  var ano = anos[i_ano];

  if      (ano == 1985) {
    var ano1 = 1985; var ano2 = 1986; var ano3 = 1987
    var asset1 = 'l5'; var asset2 = 'l5'; var asset3 = 'l5'
  }
  else if (ano == 1986) {
    var ano1 = 1986; var ano2 = 1985; var ano3 = 1987
    var asset1 = 'l5'; var asset2 = 'l5'; var asset3 = 'l5'
  }
  else if (ano == 2000) {
    var ano1 = 2000; var ano2 = 1999; var ano3 = 1998
    var asset1 = 'l7'; var asset2 = 'l5'; var asset3 = 'l5'
  }
  else if (ano == 2001)   {
    var ano1 = 2001; var ano2 = 2000; var ano3 = 1999
    var asset1 = 'l7'; var asset2 = 'l7'; var asset3 = 'l5'
  }
  else if (ano == 2002) {
    var ano1 = 2002; var ano2 = 2001; var ano3 = 2000
    var asset1 = 'l7'; var asset2 = 'l7'; var asset3 = 'l7'
  }
  else if (ano == 2003) {
    var ano1 = 2003; var ano2 = 2002; var ano3 = 2001
     var asset1 = 'l5'; var asset2 = 'l7'; var asset3 = 'l7'
  }
  else if (ano == 2004) {
    var ano1 = 2004; var ano2 = 2003; var ano3 = 2002
     var asset1 = 'l5'; var asset2 = 'l5'; var asset3 = 'l7'
  }
  else if (ano == 2012) {
    var ano1 = 2012; var ano2 = 2011; var ano3 = 2010
    var asset1 = 'l7'; var asset2 = 'l5'; var asset3 = 'l5'
  }
  else if (ano == 2013) {
    var ano1 = 2013; var ano2 = 2012; var ano3 = 2011
    var asset1 = 'l8'; var asset2 = 'l7'; var asset3 = 'l5'
  }
  else if (ano == 2014) {
    var ano1 = 2014; var ano2 = 2013; var ano3 = 2012
    var asset1 = 'l8'; var asset2 = 'l8'; var asset3 = 'l7'
  }
  else if (ano == 2015) {
    var ano1 = 2015; var ano2 = 2014; var ano3 = 2013
    var asset1 = 'l8'; var asset2 = 'l8'; var asset3 = 'l8'
  }
  else if (ano == 2016) {
    var ano1 = 2016; var ano2 = 2015; var ano3 = 2014
    var asset1 = 'l8'; var asset2 = 'l8'; var asset3 = 'l8'
  }
  else if (ano == 2017) {
    var ano1 = 2017; var ano2 = 2016; var ano3 = 2015
    var asset1 = 'l8'; var asset2 = 'l8'; var asset3 = 'l8'
  }
  else if (ano == 2018) {
    var ano1 = 2018; var ano2 = 2017; var ano3 = 2016
    var asset1 = 'l8'; var asset2 = 'l8'; var asset3 = 'l8'
  }
  else if (ano == 2019) {
    var ano1 = 2019; var ano2 = 2018; var ano3 = 2017
    var asset1 = 'l8'; var asset2 = 'l8'; var asset3 = 'l8'
  }
  else if (ano == 2020) {
    var ano1 = 2020; var ano2 = 2019; var ano3 = 2018
    var asset1 = 'l8'; var asset2 = 'l8'; var asset3 = 'l8'
  }
  else if (ano == 2021) {
    var ano1 = 2021; var ano2 = 2020; var ano3 = 2019
    var asset1 = 'l8'; var asset2 = 'l8'; var asset3 = 'l8'
  }
  else {
    var ano1 = ano; var ano2 = ( ano - 1); var ano3 = ( ano - 2)
    var asset1 = 'l5'; var asset2 = 'l5'; var asset3 = 'l5'
  }

  
var colecao6 = ee.Image('projects/mapbiomas-workspace/public/collection6/mapbiomas_collection60_integration_v1').select('classification_'+ano)
                  .remap(
                  [3, 4, 5, 9,11,12,13,15,18,19,20,36,39,41,21,22,23,24,25,26,29,30,31,32,33],
                  [3, 4, 3, 9,11,12,13,21,21,21,21,21,21,21,21,22,22,22,22,33,29,22,33,13,33]);

  var mosaicoC3 = ee.ImageCollection('projects/mapbiomas-workspace/MOSAICOS/workspace-c3')
                      .filterMetadata('biome', 'equals', bioma)
                      .filterMetadata('year', 'equals', ano )
                      .filterBounds(limite)
                      .mosaic()
    // Map.addLayer(mosaicoC3, {'bands':['median_swir1','median_nir','median_red'], 'gain':[0.08, 0.06,0.2],'gamma':0.5 }, 'C3_Img_Year_'+ano, false);


    var mosaicoTotal = ee.ImageCollection(asset_mosaicos_col6)
                        .filterMetadata('biome', 'equals', bioma)
                        .filterMetadata('year', 'equals', ano1)
                        .filter(ee.Filter.eq('satellite', asset1))
                        .filterBounds(limite)
                        .mosaic()

    var mosaico1ano_antes = ee.ImageCollection(asset_mosaicos_col6)
                      .filterMetadata('biome', 'equals', bioma)
                      .filterMetadata('year', 'equals', ano2)
                      .filter(ee.Filter.eq('satellite', asset2))
                      .filterBounds(limite)
                      .mosaic()

    var mosaico2anos_antes = ee.ImageCollection(asset_mosaicos_col6)
                      .filterMetadata('biome', 'equals', bioma)
                      .filterMetadata('year', 'equals', ano3)
                      .filter(ee.Filter.eq('satellite', asset3))
                      .filterBounds(limite)
                      .mosaic()
                      
    var mosaico85 = ee.ImageCollection(asset_mosaicos_col6)
                      .filterMetadata('biome', 'equals', bioma)
                      .filterMetadata('year', 'equals', 1985)
                      .filter(ee.Filter.eq('satellite', 'l5'))
                      .filterBounds(limite)
                      .mosaic()
    var mosaico86 = ee.ImageCollection(asset_mosaicos_col6)
                      .filterMetadata('biome', 'equals', bioma)
                      .filterMetadata('year', 'equals', 1986)
                      .filter(ee.Filter.eq('satellite', 'l5'))
                      .filterBounds(limite)
                      .mosaic()

    var min3anos = ee.ImageCollection.fromImages([mosaicoTotal.select('ndvi_median'),
                                                  mosaico1ano_antes.select('ndvi_median'),
                                                  mosaico2anos_antes.select('ndvi_median')]).min()
    
    var max3anos = ee.ImageCollection.fromImages([mosaicoTotal.select('ndvi_median_wet'),
                                                  mosaico1ano_antes.select('ndvi_median_wet'),
                                                  mosaico2anos_antes.select('ndvi_median_wet')]).max()

    var amp3anos_ndvi = max3anos.subtract(min3anos).rename('amp_ndvi_3anos')
//    Map.addLayer(amp3anos_ndvi, {'min':0, 'max':500, 'palette':ndvi_color}, 'amp3anos_ndvi', true);
    mosaicoTotal = mosaicoTotal.addBands(amp3anos_ndvi)

    var min3anos = ee.ImageCollection.fromImages([mosaicoTotal.select('ndfi_median_wet'),
                                                  mosaico1ano_antes.select('ndfi_median_wet'),
                                                  mosaico2anos_antes.select('ndfi_median_wet')]).min()
    
    var max3anos = ee.ImageCollection.fromImages([mosaicoTotal.select('ndfi_median_wet'),
                                                  mosaico1ano_antes.select('ndfi_median_wet'),
                                                  mosaico2anos_antes.select('ndfi_median_wet')]).max()

    var amp3anos_ndfi = max3anos.subtract(min3anos).rename('amp_nfvi_3anos')
    mosaicoTotal = mosaicoTotal.addBands(amp3anos_ndfi)

     var ll = ee.Image.pixelLonLat().clip(limite);
    
    var long = ll.select('longitude').add(34.8).multiply(-1).multiply(1000).toInt16()
    var lati = ll.select('latitude').add(5).multiply(-1).multiply(1000).toInt16()
    
    mosaicoTotal = mosaicoTotal.addBands(long.rename('longitude'))
    mosaicoTotal = mosaicoTotal.addBands(lati.rename('latitude' ))

  var BDamostras = ee.FeatureCollection(dir_pt_in+'pontos_train_'+versao_pt+'_'+ano)
                    .filterMetadata('reg_id', 'equals', regiaoID)
                    
  if (coleta) {    
//    print(BDamostras.limit(100))
//    Map.addLayer(mosaico85, visParMedian2, 'Img_Year_85', false);  
//    Map.addLayer(mosaico86, visParMedian2, 'Img_Year_86', false);  
    Map.addLayer(mosaicoTotal, visParMedian2, 'Img_Year_'+ano, false);
//    Map.addLayer(colecao5.clip(limite), vis, 'Colecao 5 - '+ano, true);
//    Map.addLayer(mosaicoC3, {'bands':['median_swir1','median_nir','median_red'], 'gain':[0.08, 0.06,0.2],'gamma':0.5 }, 'C3_Img_Year_'+ano, false);
    }
    
    var BDflo = BDamostras.filterMetadata("reference", "equals", 3)
    var BDsav = BDamostras.filterMetadata("reference", "equals", 4)//.limit(100)
    var BDreflo = BDamostras.filterMetadata("reference", "equals", 9)
    var BDvarzea = BDamostras.filterMetadata("reference", "equals", 11)
    var BDcampo = BDamostras.filterMetadata("reference", "equals", 12)
    var BDOutroNFlo = BDamostras.filterMetadata("reference", "equals", 13)
    var BDagro = BDamostras.filterMetadata("reference", "equals", 21)
    // BDagro = shuffle(BDagro, 2).limit(1000)
    var BDNaoVeg = BDamostras.filterMetadata("reference", "equals", 22)
    var BDAflora = BDamostras.filterMetadata("reference", "equals", 29)
    var BDagua = BDamostras.filterMetadata("reference", "equals", 33)



  var training = BDflo.merge(BDreflo).merge(BDcampo)//.merge(BDsav).merge(BDOutroNFlo).merge(BDAflora)
                      .merge(BDagro).merge(BDNaoVeg).merge(BDagua)

  var classifier = ee.Classifier.smileRandomForest({numberOfTrees: RFtrees, variablesPerSplit:1}).train(training, 'reference', bandNames);
  // print(classifier.explain())
  var classified = mosaicoTotal.classify(classifier).mask(mosaicoTotal.select('blue_median'));
  classified = classified.select(['classification'],['classification_'+ano]).clip(limite.geometry()).toInt8()
if (coleta) {  Map.addLayer(classified, vis, 'RF'+ano+"_"+regiaoID, false);}

  if (i_ano == 0){ var classified85a21 = classified }  
  else {classified85a21 = classified85a21.addBands(classified); }
  
}


classified85a21 = classified85a21
.set('territory', 'BRAZIL')
.set('biome', 'MATA ATNTICA')
.set('source', 'arcplan')
.set('version', '2')
.set('year', versao_out)
.set('collection_id', 7.0)

//print(classified85a21)

Export.image.toAsset({
  "image": classified85a21.toInt8(),
  "description": regiaoID+'-'+'RF85a21_v'+versao_out,
  "assetId": dirout + regiaoID+'-'+'RF85a21_v'+versao_out,
  "scale": 30,
  "pyramidingPolicy": {
      '.default': 'mode'
  },
  "maxPixels": 1e13,
  "region": limite
});    
